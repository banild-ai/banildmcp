/**
 * Enterprise Authentication Middleware for QuickMCP
 * Supports multiple authentication methods for enterprise use
 */
import { Request, Response, NextFunction } from 'express';
export interface AuthConfig {
    type: 'bearer' | 'api-key' | 'oauth2' | 'custom';
    secret?: string;
    apiKeys?: string[];
    verify?: (token: string) => Promise<boolean>;
    extractUser?: (token: string) => Promise<any>;
}
export interface AuthenticatedRequest extends Request {
    user?: any;
    authType?: string;
}
/**
 * Authentication middleware factory
 */
export declare class AuthMiddleware {
    private config;
    constructor(config: AuthConfig);
    /**
     * Express middleware function
     */
    middleware: (req: AuthenticatedRequest, res: Response, next: NextFunction) => Promise<void>;
    /**
     * Extract token from request
     */
    private extractToken;
    /**
     * Validate token based on configuration
     */
    private validateToken;
    /**
     * Validate JWT token
     */
    private validateJWT;
    /**
     * Validate API key
     */
    private validateApiKey;
    /**
     * Send unauthorized response
     */
    private unauthorized;
}
/**
 * Rate limiting middleware
 */
export declare class RateLimitMiddleware {
    private limiter;
    constructor(options: {
        points: number;
        duration: number;
    });
    middleware: (req: Request, res: Response, next: NextFunction) => Promise<void>;
}
/**
 * Metrics collection middleware
 */
export declare class MetricsMiddleware {
    private metrics;
    middleware: (req: AuthenticatedRequest, res: Response, next: NextFunction) => void;
    /**
     * Get metrics summary
     */
    getMetrics(): {
        uptime: number;
        totalRequests: number;
        totalErrors: number;
        errorRate: number;
        avgResponseTime: number;
        requestsPerSecond: number;
        toolCalls: {
            [k: string]: number;
        };
    };
    /**
     * Reset metrics
     */
    reset(): void;
}
//# sourceMappingURL=auth.d.ts.map